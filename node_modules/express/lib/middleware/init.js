/*!
 * express
 * Copyright(c) 2009-2013 TJ Holowaychuk
 * Copyright(c) 2013 Roman Shtylman
 * Copyright(c) 2014-2015 Douglas Christopher Wilson
 * MIT Licensed
 */

'use strict';

/**
<<<<<<< HEAD
=======
<<<<<<< HEAD
=======
<<<<<<< HEAD
=======
<<<<<<< HEAD
>>>>>>> 0d181195da54bd2c368194c48ad26cc82c169f9a
>>>>>>> 0458b7681f61a1a13646e680ffd1e87b47607913
>>>>>>> d558e76119e3e92dd54c9fead9e84207736a0741
 * Module dependencies.
 * @private
 */

var setPrototyeOf = require('setprototypeof')

/**
<<<<<<< HEAD
=======
<<<<<<< HEAD
=======
<<<<<<< HEAD
=======
=======
>>>>>>> 04021d3ff90fcfc29304fad713156bc7eed094e0
>>>>>>> 0d181195da54bd2c368194c48ad26cc82c169f9a
>>>>>>> 0458b7681f61a1a13646e680ffd1e87b47607913
>>>>>>> d558e76119e3e92dd54c9fead9e84207736a0741
 * Initialization middleware, exposing the
 * request and response to each other, as well
 * as defaulting the X-Powered-By header field.
 *
 * @param {Function} app
 * @return {Function}
 * @api private
 */

exports.init = function(app){
  return function expressInit(req, res, next){
    if (app.enabled('x-powered-by')) res.setHeader('X-Powered-By', 'Express');
    req.res = res;
    res.req = req;
    req.next = next;

<<<<<<< HEAD
    setPrototyeOf(req, app.request)
    setPrototyeOf(res, app.response)
=======
<<<<<<< HEAD
    setPrototyeOf(req, app.request)
    setPrototyeOf(res, app.response)
=======
<<<<<<< HEAD
    setPrototyeOf(req, app.request)
    setPrototyeOf(res, app.response)
=======
<<<<<<< HEAD
    setPrototyeOf(req, app.request)
    setPrototyeOf(res, app.response)
=======
    req.__proto__ = app.request;
    res.__proto__ = app.response;
>>>>>>> 04021d3ff90fcfc29304fad713156bc7eed094e0
>>>>>>> 0d181195da54bd2c368194c48ad26cc82c169f9a
>>>>>>> 0458b7681f61a1a13646e680ffd1e87b47607913
>>>>>>> d558e76119e3e92dd54c9fead9e84207736a0741

    res.locals = res.locals || Object.create(null);

    next();
  };
};

